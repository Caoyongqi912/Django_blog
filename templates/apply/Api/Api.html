{% extends 'base.html' %}
{% block title %}
    Request
{% endblock %}
{% block post %}
    <form action="{% url 'Api:send' %}" method="post">
        {% csrf_token %}

        <div class="input-group">
            <div class="input-group-btn">
                <button id="but_val" type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"
                        aria-haspopup="true" aria-expanded="false">GET
                </button>
                <input type="hidden" name="hidedrop_1" id="hidedrop_1"/>
                <ul class="dropdown-menu">
                    <li><a href="#" id="GET">GET</a></li>
                    <li role="separator" class="divider"></li>
                    <li><a href="#" id="POST">POST</a></li>
                    <li role="separator" class="divider"></li>
                    <li><a href="#" id="PUT">PUT</a></li>
                    <li role="separator" class="divider"></li>
                    <li><a href="#" id="DELETE">DELETE</a></li>
                </ul>
            </div>
            <input type="text" class="form-control" aria-label="..." placeholder="Enter request URL" id="url">
            <span class="input-group-btn">
        <button class="btn btn-success" type="button" id="send">Send </button>
      </span>
        </div>
        <br>
        <div class="hidden alert-danger" role="alert" id="err">
            <a href="#" class="alert-link">路由不能为空..</a>
        </div>
    </form>
    <!-- Split button -->
    <br><br><br>
    <div>
        <ul class="nav nav-tabs" role="tablist">
            <li role="presentation" class="active"><a href="#home" aria-controls="home" role="tab" data-toggle="tab">Params</a>
            </li>
            <li role="presentation"><a href="#profile" aria-controls="profile" role="tab" data-toggle="tab">Headers</a>
            </li>

        </ul>
        <div class="tab-content">
            <div role="tabpanel" class="tab-pane active" id="home">
                <br><br><br>
                <div class="row">
                    <div class="col-lg-6">
                        <div class="input-group">
                              <span class="input-group-addon">
                                <input type="checkbox" aria-label="...">
                              </span>
                            <input type="text" class="form-control" aria-label="..." placeholder="wait..">
                        </div><!-- /input-group -->
                    </div><!-- /.col-lg-6 -->
                    <div class="col-lg-6">
                        <div class="input-group">
                              <span class="input-group-addon">
                                <input type="radio" aria-label="...">
                              </span>
                            <input type="text" class="form-control" aria-label="...">
                        </div><!-- /input-group -->
                    </div><!-- /.col-lg-6 -->
                </div>
                <br>
                <div class="row">
                    <div class="col-lg-6">
                        <div class="input-group">
                              <span class="input-group-addon">
                                <input type="checkbox" aria-label="...">
                              </span>
                            <input type="text" class="form-control" aria-label="...">
                        </div><!-- /input-group -->
                    </div><!-- /.col-lg-6 -->
                    <div class="col-lg-6">
                        <div class="input-group">
                              <span class="input-group-addon">
                                <input type="radio" aria-label="...">
                              </span>
                            <input type="text" class="form-control" aria-label="...">
                        </div><!-- /input-group -->
                    </div><!-- /.col-lg-6 -->
                </div>
                <br>
                <div class="row">
                    <div class="col-lg-6">
                        <div class="input-group">
                              <span class="input-group-addon">
                                <input type="checkbox" aria-label="...">
                              </span>
                            <input type="text" class="form-control" aria-label="...">
                        </div><!-- /input-group -->
                    </div><!-- /.col-lg-6 -->
                    <div class="col-lg-6">
                        <div class="input-group">
                              <span class="input-group-addon">
                                <input type="radio" aria-label="...">
                              </span>
                            <input type="text" class="form-control" aria-label="...">
                        </div><!-- /input-group -->
                    </div><!-- /.col-lg-6 -->
                </div>
                <br>
                <div class="row">
                    <div class="col-lg-6">
                        <div class="input-group">
                              <span class="input-group-addon">
                                <input type="checkbox" aria-label="...">
                              </span>
                            <input type="text" class="form-control" aria-label="...">
                        </div><!-- /input-group -->
                    </div><!-- /.col-lg-6 -->
                    <div class="col-lg-6">
                        <div class="input-group">
                              <span class="input-group-addon">
                                <input type="radio" aria-label="...">
                              </span>
                            <input type="text" class="form-control" aria-label="...">
                        </div><!-- /input-group -->
                    </div><!-- /.col-lg-6 -->
                </div>
            </div>

            <div role="tabpanel" class="tab-pane" id="profile"><br><br><br>
                <div class="row">
                    <div class="col-lg-6">
                        <div class="input-group">
                              <span class="input-group-addon">
                                <input type="checkbox" aria-label="...">
                              </span>
                            <input type="text" class="form-control" aria-label="..." value="User-Agent"
                                   placeholder="User-Agent:" readonly>
                        </div>
                        <br>
                        <div class="input-group">
                              <span class="input-group-addon">
                                <input type="checkbox" aria-label="...">
                              </span>
                            <input type="text" class="form-control" aria-label="..." value="Host"
                                   placeholder="Host:" readonly>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="input-group">
                              <span class="input-group-addon">
                                <input type="radio" aria-label="...">
                              </span>
                            <input type="text" class="form-control" aria-label="..." id="Ua" placeholder="输入没用。">
                        </div>
                        <br>
                        <div class="input-group">
                              <span class="input-group-addon">
                                <input type="radio" aria-label="...">
                              </span>
                            <input type="text" class="form-control" aria-label="..." id="Host">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <br><br><br><br>
    <div class="well"><textarea class="form-control" rows="7" id="text_res"></textarea>
    </div>
{% endblock %}

{% block js %}
    <script>
        $('#send').click(function () {
            var url = $('#url').val();
            var but = $('#but_val').text();
            console.log(url);
            console.log(but);
            if (url == '') {
                $('#err').removeClass('hidden').addClass('alert')
            } else if (url !== '') {
                $('#err').removeClass('alert').addClass('hidden')

            } else {
            }
            $.post('{% url "Api:send" %}', {
                    'url': url,
                    'method': but,
                    csrfmiddlewaretoken: '{{ csrf_token }}'
                }, function (data) {
                    {#console.log(data.res);#}
                    var str = 'html';
                    if (data.res.indexOf(str) > -1) {
                        $('#text_res').text(data.res);
                    } else if (data.res == 'fail') {
                        $('#text_res').text('错误')

                    } else {

                        var result = JSON.stringify(JSON.parse(data.res), null, 4);
                        $('#text_res').text(result)
                    }


                }
            )

        });
        $("#DELETE").click(function () {
            $('#but_val').text("DELETE");
        });
        $('#PUT').click(function () {
            $('#but_val').text('PUT')
        });
        $('#POST').click(function () {
            $('#but_val').text('POST')
        });
        $('#GET').click(function () {
            $('#but_val').text('GET')
        });
    </script>



{% endblock %}